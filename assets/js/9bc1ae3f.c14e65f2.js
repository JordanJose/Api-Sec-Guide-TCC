"use strict";(self.webpackChunkapi_security_basic_guide=self.webpackChunkapi_security_basic_guide||[]).push([[313],{3905:(e,a,n)=>{n.d(a,{Zo:()=>d,kt:()=>m});var o=n(7294);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function t(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?t(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function i(e,a){if(null==e)return{};var n,o,r=function(e,a){if(null==e)return{};var n,o,r={},t=Object.keys(e);for(o=0;o<t.length;o++)n=t[o],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(o=0;o<t.length;o++)n=t[o],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=o.createContext({}),l=function(e){var a=o.useContext(u),n=a;return e&&(n="function"==typeof e?e(a):s(s({},a),e)),n},d=function(e){var a=l(e.components);return o.createElement(u.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},c=o.forwardRef((function(e,a){var n=e.components,r=e.mdxType,t=e.originalType,u=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=l(n),m=r,f=c["".concat(u,".").concat(m)]||c[m]||p[m]||t;return n?o.createElement(f,s(s({ref:a},d),{},{components:n})):o.createElement(f,s({ref:a},d))}));function m(e,a){var n=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var t=n.length,s=new Array(t);s[0]=c;var i={};for(var u in a)hasOwnProperty.call(a,u)&&(i[u]=a[u]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<t;l++)s[l]=n[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3347:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>u,contentTitle:()=>s,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>l});var o=n(7462),r=(n(7294),n(3905));const t={sidebar_position:3},s="Corre\xe7\xe3o",i={unversionedId:"Vulnerabilidades/Excessive_Data_Exposure/correcao",id:"Vulnerabilidades/Excessive_Data_Exposure/correcao",title:"Corre\xe7\xe3o",description:"---",source:"@site/docs/Vulnerabilidades/5_Excessive_Data_Exposure/correcao.md",sourceDirName:"Vulnerabilidades/5_Excessive_Data_Exposure",slug:"/Vulnerabilidades/Excessive_Data_Exposure/correcao",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/correcao",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"Explora\xe7\xe3o",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/exploracao"},next:{title:"Refer\xeancias",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/referencias"}},u={},l=[{value:"Identificando trecho de c\xf3digo vulner\xe1vel",id:"identificando-trecho-de-c\xf3digo-vulner\xe1vel",level:2},{value:"Mais refer\xeancias dispon\xedveis na OWASP.",id:"mais-refer\xeancias-dispon\xedveis-na-owasp",level:4}],d={toc:l};function p(e){let{components:a,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"corre\xe7\xe3o"},"Corre\xe7\xe3o"),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Essa vulnerabilidade pode acontecer por v\xe1rios motivos, mas h\xe1 algumas dicas que podem ser usadas para corrigi-las:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"N\xe3o fa\xe7a com que o front-end filtre as informa\xe7\xf5es que n\xe3o s\xe3o necess\xe1rias, deixe isso a cargo do back-end, de modo que envie somente as informa\xe7\xf5es pertinentes e necess\xe1rias ao usu\xe1rio.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Tenha um invent\xe1rio dos endpoints de debug e garanta que n\xe3o h\xe1 nenhum exposto no ambiente de produ\xe7\xe3o, principalmente se n\xe3o houver nenhum tipo de gest\xe3o de acessos.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Classifique as informa\xe7\xf5es que s\xe3o sens\xedveis e realize um controle mais rigoroso, garantindo que n\xe3o ser\xe3o acessadas por usu\xe1rios sem permiss\xe3o."))),(0,r.kt)("h2",{id:"identificando-trecho-de-c\xf3digo-vulner\xe1vel"},"Identificando trecho de c\xf3digo vulner\xe1vel"),(0,r.kt)("p",null,"Para que uma corre\xe7\xe3o possa ser realizada, \xe9 necess\xe1rio encontrar o(s) trecho(s) de c\xf3digo da aplica\xe7\xe3o que utilizam esse m\xe9todo de autentica\xe7\xe3o falho."),(0,r.kt)("p",null,"Ao analisar a rota ",(0,r.kt)("inlineCode",{parentName:"p"},"/users/v1/_debug")," na documenta\xe7\xe3o da VAmPI (dispon\xedvel de acordo com o formato ",(0,r.kt)("a",{parentName:"p",href:"https://swagger.io/specification/"},"OpenAPI 3.0"),"), \xe9 poss\xedvel encontrar a fun\xe7\xe3o respons\xe1vel pela consultas das informa\xe7\xf5es dos usu\xe1rios lendo o ",(0,r.kt)("inlineCode",{parentName:"p"},"operationId"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml",metastring:'title="openapi3.yml - /users/v1/{username}/password"',title:'"openapi3.yml',"-":!0,'/users/v1/{username}/password"':!0},"...\noperationId: api_views.users.debug\n...\n")),(0,r.kt)("p",null,"Agora, basta seguir o caminho entre os arquivos da VAmPI para encontrar a fun\xe7\xe3o vulner\xe1vel na aplica\xe7\xe3o."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="api_views/users.debug"',title:'"api_views/users.debug"'},"def debug():\n    return_value = jsonify({'users': User.get_all_users_debug()})\n    return return_value\n")),(0,r.kt)("p",null,"\xc9 poss\xedvel notar que a fun\xe7\xe3o de debug \xe9 simples, implementada apenas para realizar testes no ambiente de desenvolvimento da aplica\xe7\xe3o, por\xe9m, acabou sendo dispobilizada no ambiente de produ\xe7\xe3o."),(0,r.kt)("p",null,"Nesse caso, a melhor forma de corrigir essa vulnerabilidade \xe9 removendo esse endpoint do ambiente de produ\xe7\xe3o, tendo em vista que n\xe3o h\xe1 necessidade, contribuindo apenas para que a aplica\xe7\xe3o seja mais vulner\xe1vel."),(0,r.kt)("p",null,"Com o endpoint removido da aplica\xe7\xe3o, ao fazer uma requisi\xe7\xe3o ser\xe1 exibida apenas uma mensagem de erro, mostrando que os dados de todos os usu\xe1rios n\xe3o est\xe3o mais sendo expostos."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Request para o endpoint de debug ap\xf3s exclus\xe3o"',title:'"Request',para:!0,o:!0,endpoint:!0,de:!0,debug:!0,"ap\xf3s":!0,'exclus\xe3o"':!0},"GET /users/v1/_debug HTTP/1.1\nUser-Agent: PostmanRuntime/7.29.2\nAccept: */*\nPostman-Token: 9b2c1f71-db86-424e-b161-4a4bef1cad51\nHost: localhost:5000\nAccept-Encoding: gzip, deflate\nConnection: close\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Response do endpoint de debug ap\xf3s exclus\xe3o"',title:'"Response',do:!0,endpoint:!0,de:!0,debug:!0,"ap\xf3s":!0,'exclus\xe3o"':!0},'HTTP/1.0 404 NOT FOUND\nContent-Type: application/json\nContent-Length: 48\nServer: Werkzeug/1.0.1 Python/3.8.10\nDate: Wed, 01 Feb 2023 04:02:49 GMT\n\n{ \n    "status": "fail",\n    "message": "User not found"\n}\n')),(0,r.kt)("p",null,"Agora, debug \xe9 tratado apenas como um nome de usu\xe1rio e n\xe3o como um endpoint, evitando que dados em excesso sejam expostos."),(0,r.kt)("h4",{id:"mais-refer\xeancias-dispon\xedveis-na-owasp"},"Mais refer\xeancias dispon\xedveis na ",(0,r.kt)("a",{parentName:"h4",href:"https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa3-excessive-data-exposure.md"},"OWASP"),"."))}p.isMDXComponent=!0}}]);