"use strict";(self.webpackChunkapi_security_basic_guide=self.webpackChunkapi_security_basic_guide||[]).push([[9763],{3905:(e,a,n)=>{n.d(a,{Zo:()=>p,kt:()=>m});var o=n(7294);function s(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,o)}return n}function t(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){s(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function i(e,a){if(null==e)return{};var n,o,s=function(e,a){if(null==e)return{};var n,o,s={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],a.indexOf(n)>=0||(s[n]=e[n]);return s}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var d=o.createContext({}),l=function(e){var a=o.useContext(d),n=a;return e&&(n="function"==typeof e?e(a):t(t({},a),e)),n},p=function(e){var a=l(e.components);return o.createElement(d.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},c=o.forwardRef((function(e,a){var n=e.components,s=e.mdxType,r=e.originalType,d=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=l(n),m=s,b=c["".concat(d,".").concat(m)]||c[m]||u[m]||r;return n?o.createElement(b,t(t({ref:a},p),{},{components:n})):o.createElement(b,t({ref:a},p))}));function m(e,a){var n=arguments,s=a&&a.mdxType;if("string"==typeof e||s){var r=n.length,t=new Array(r);t[0]=c;var i={};for(var d in a)hasOwnProperty.call(a,d)&&(i[d]=a[d]);i.originalType=e,i.mdxType="string"==typeof e?e:s,t[1]=i;for(var l=2;l<r;l++)t[l]=n[l];return o.createElement.apply(null,t)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},9898:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var o=n(7462),s=(n(7294),n(3905));const r={sidebar_position:2},t="Explora\xe7\xe3o",i={unversionedId:"Vulnerabilidades/Excessive_Data_Exposure/exploracao",id:"Vulnerabilidades/Excessive_Data_Exposure/exploracao",title:"Explora\xe7\xe3o",description:"---",source:"@site/docs/Vulnerabilidades/5_Excessive_Data_Exposure/exploracao.md",sourceDirName:"Vulnerabilidades/5_Excessive_Data_Exposure",slug:"/Vulnerabilidades/Excessive_Data_Exposure/exploracao",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/exploracao",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Descri\xe7\xe3o",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/descricao"},next:{title:"Corre\xe7\xe3o",permalink:"/Api-Sec-Guide-TCC/docs/Vulnerabilidades/Excessive_Data_Exposure/correcao"}},d={},l=[{value:"Rota de debug",id:"rota-de-debug",level:2},{value:"Mais refer\xeancias dispon\xedveis na OWASP.",id:"mais-refer\xeancias-dispon\xedveis-na-owasp",level:4}],p={toc:l};function u(e){let{components:a,...n}=e;return(0,s.kt)("wrapper",(0,o.Z)({},p,n,{components:a,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"explora\xe7\xe3o"},"Explora\xe7\xe3o"),(0,s.kt)("hr",null),(0,s.kt)("p",null,"Tendo em mente os questionamentos levantados ao final da sess\xe3o anterior, \xe9 poss\xedvel realizar os testes de seguran\xe7a a fim de descobrir onde a vulnerabilidade pode ser explorada."),(0,s.kt)("p",null,"A melhor forma de explorar essa vulnerabilidade \xe9 estudando o comportamento da API, lendo a sua documenta\xe7\xe3o e analisando as respostas de todos os endpoints, procurando por informa\xe7\xf5es em excesso que s\xe3o enviadas para o cliente, por esse motivo que \xe9 importante o uso de um proxy."),(0,s.kt)("h2",{id:"rota-de-debug"},"Rota de debug"),(0,s.kt)("p",null,"Uma das formas para descobrir se uma API possui esse tipo de vulnerabilidade \xe9 consultar as rotas de debug, mesmo que n\xe3o constem na documenta\xe7\xe3o (ser\xe1 necess\xe1rio um esfor\xe7o para deduzir as poss\xedveis rotas)."),(0,s.kt)("p",null,"Rotas de debug s\xe3o comumente usadas por desenvolvedores para realizar testes na aplica\xe7\xe3o no ambiente de desenvolvimento e, por essa raz\xe3o, costumam trazer informa\xe7\xf5es sens\xedveis de muitos usu\xe1rios ou sistemas internos."),(0,s.kt)("p",null,"Por\xe9m, h\xe1 casos de rotas de debug da aplica\xe7\xe3o que v\xe3o para o ambiente de produ\xe7\xe3o e, at\xe9 mesmo, acabam sendo documentadas, expondo informa\xe7\xf5es sens\xedveis para qualquer um que conhe\xe7a esse endpoint."),(0,s.kt)("p",null,"Ao consultar a documenta\xe7\xe3o da VAmPI \xe9 poss\xedvel encontrar um endpoit de debug, o ",(0,s.kt)("inlineCode",{parentName:"p"},"/users/v1/_debug"),", que possui a seguinte descri\xe7\xe3o:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-yml",metastring:'title="Trecho de documenta\xe7\xe3o da VAmPI"',title:'"Trecho',de:!0,"documenta\xe7\xe3o":!0,da:!0,'VAmPI"':!0},"...\ndescription: Displays all details for all users\n...\n")),(0,s.kt)("p",null,"Traduzindo, significa que essa rota retornar\xe1 ",(0,s.kt)("strong",{parentName:"p"},"todos os detalhes")," de ",(0,s.kt)("strong",{parentName:"p"},"todos os usu\xe1rios")," da aplica\xe7\xe3o. Podendo ser uma vulnerabilidade muito grave, caso n\xe3o haja nenhum tipo de controle de acessos."),(0,s.kt)("p",null,"Ent\xe3o, para consultar se h\xe1 a exposi\xe7\xe3o excessiva de dados, basta realizar uma requisi\xe7\xe3o do tipo ",(0,s.kt)("inlineCode",{parentName:"p"},"GET")," para a rota ",(0,s.kt)("inlineCode",{parentName:"p"},"/users/v1/_debug"),", j\xe1 que n\xe3o h\xe1 a necessidade de informar nenhum tipo de token de autentica\xe7\xe3o."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Request para o endpoint de debud da aplica\xe7\xe3o"',title:'"Request',para:!0,o:!0,endpoint:!0,de:!0,debud:!0,da:!0,'aplica\xe7\xe3o"':!0},"GET /users/v1/_debug HTTP/1.1\nUser-Agent: PostmanRuntime/7.29.2\nAccept: */*\nPostman-Token: 9b2c1f71-db86-424e-b161-4a4bef1cad51\nHost: localhost:5000\nAccept-Encoding: gzip, deflate\nConnection: close\n")),(0,s.kt)("p",null,"Ent\xe3o, obtivemos a seguinte resposta do servidor:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="Response do endpoint de debug da aplica\xe7\xe3o"',title:'"Response',do:!0,endpoint:!0,de:!0,debug:!0,da:!0,'aplica\xe7\xe3o"':!0},'HTTP/1.0 200 OK\nContent-Type: application/json\nContent-Length: 1000\nServer: Werkzeug/1.0.1 Python/3.8.10\nDate: Wed, 01 Feb 2023 03:24:54 GMT\n\n{\n  "users": [\n    {\n      "admin": false, \n      "email": "mail1@mail.com", \n      "password": "password", \n      "username": "name1"\n    }, \n    {\n      "admin": false, \n      "email": "mail2@mail.com", \n      "password": "passvuln", \n      "username": "name2"\n    }, \n    {\n      "admin": true, \n      "email": "admin@mail.com", \n      "password": "pass1", \n      "username": "admin"\n    }, \n    {\n      "admin": false, \n      "email": "jjga.snf19@uea.edu.br", \n      "password": "password", \n      "username": "jordan"\n    }, \n    {\n      "admin": false, \n      "email": "UserMass@massassignment.com", \n      "password": "strongpassword", \n      "username": "UserMass"\n    }, \n    {\n      "admin": false, \n      "email": "TestAdministrator@massassignment.com", \n      "password": "adminpass", \n      "username": "TestAdministrator"\n    }, \n    {\n      "admin": true, \n      "email": "admin@massassignment.com", \n      "password": "adminpass", \n      "username": "AdminMassAssignment"\n    }\n  ]\n}\n')),(0,s.kt)("p",null,"Na resposta, foi poss\xedvel obter um json com as informa\xe7\xf5es de ",(0,s.kt)("strong",{parentName:"p"},"todos os usu\xe1rios")," da aplica\xe7\xe3o, at\xe9 mesmo as senhas que est\xe3o armazenadas, sem necessitar de nenhum tipo de autentica\xe7\xe3o ou acesso de administra\xe7\xe3o, comprovando que h\xe1 a exposi\xe7\xe3o de informa\xe7\xf5es sens\xedveis."),(0,s.kt)("h4",{id:"mais-refer\xeancias-dispon\xedveis-na-owasp"},"Mais refer\xeancias dispon\xedveis na ",(0,s.kt)("a",{parentName:"h4",href:"https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa5-broken-function-level-authorization.md"},"OWASP"),"."))}u.isMDXComponent=!0}}]);